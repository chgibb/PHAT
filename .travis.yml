language: node_js
sudo: required
node_js:
- '6'
addons:
  apt:
    sources:
    - ubuntu-toolchain-r-test
    packages:
    - xvfb
    - g++-5
    - fakeroot
    - gtk2.0
    - rpm
install:
- export DISPLAY=':99.0'
- Xvfb :99 -screen 0 1024x768x24 > /dev/null 2>&1 &
- bash scripts/install.bash
- bash scripts/buildtests.bash
script:
- npm test
- bash scripts/cleanTests.bash
- bash scripts/prepareLinuxRelease.bash
notifications:
  slack: zehbelab:BuLG0b1qhVzAyihGf2XbQU4D
deploy:
  provider: releases
  api_key:
    - secure: "qMZt79guX6zWntkgWesJ26SITNhdDmq4qzpQiZT0Ddx2gP+kiAn7r8h1dpTKC+505qYdNcikGWNXkcZtuVrUy5AMINeLaH1j/R0QZXhWvruFIxx9ClHzXHnicDT8JMr4XE/WyzWgOgYZXKp3RzZILHlZhOSAZJjlaF54vLC06hZS6sSWy2EOyHVvsVQ/qIJo1Hgfj3ZMaUl3NgvcOluoIXSU/DmsAx/j4vZKGGVOhssRS69MYUvnyabKaKTD9+O8wRHkUCIhch8mVJsypPKtMD6tNlJDNUUd3OXJbbkK/SIaCAcAQjZ6y6U2xq9w2kzF8t4bcoMqJZKRO9jt/UoOdggMWra3jTIxkPGzBKU0s4YYKs/DJBTH2H5AoxbDUjCqxCtt3zBBM5LZLON1qrHHHcAmPQmTAZLqZmYMbSoGcLeSWw6Nx+vtQTnwi/dbn17BmxjHmu6LuLQeUQqIvoQufsch7zKJQDJmjWsAI2bjBLKeQoaVdyQxcqIqztQuS5FXL+P5SEQGzD59xn7zzPWF0ZmMuZLsPKBuFMVpqVzdTEWvgKLJfjvSiIZb71waTDQlYguezqxlOUa2+yQdfK/cnnBp+Oixx8C8xE4IXEGCwXi+ZhUZ3WEKDxhU9GAwPUaNBBXuNiiCU57BARTWes1AW0TQ53JiRxTA+tKSRg4F8I8="
  file_glob: true
  file:
  - phat-linux-x64-portable.tar.gz
  - phat-linux-x64-update-full.tar.gz
  - phat-linux-x64-update-diff.tar.gz
  - phat-linux-x64-update.tar.gz
  - phat*.deb
  - phat*.rpm
  skip_cleanup: true
  on:
    repo: chgibb/PHAT
    tags: true
