language: node_js
sudo: required
node_js:
- '6'
addons:
  apt:
    sources:
    - ubuntu-toolchain-r-test
    packages:
    - xvfb
    - g++-5
    - fakeroot
    - gtk2.0
    - rpm
install:
  - export DISPLAY=':99.0'
  - Xvfb :99 -screen 0 1024x768x24 > /dev/null 2>&1 &
  - bash scripts/install.bash
  - bash scripts/buildtests.bash
script:
  - npm test
  - bash scripts/cleanTests.bash
  - bash scripts/prepareLinuxRelease.bash
notifications:
  slack: zehbelab:BuLG0b1qhVzAyihGf2XbQU4D
deploy:
  provider: releases
  api_key:
    secure: b2kCTB5QBZIt0Q/+dZCWPjlh74xLGbbJ8LvYiUb56wK67JdsNAIBLWOClNKjzWtJy43Y2/aN2Y8RNrszP6e0gR1iNqVRwXfqdsIadYfYESs8xrNnEgNHYCjX47zLsc/ag++pXOQILhcgGHQkfLkXbvB7RYpxTWXH9eUEh/BKytNHPg8OwRW3LdwYNmXKJSYV8Hm7mmNsMIrrO1jO4EToT3dJsfVvazUE9eCuf87cQqoVomRSJ31qyBP5HrLLDWnH20NnEOM/B4S921axai9CFXFJQ7+50GZmhOgUpUCND3iMtInzKZydTHfoa82XK3E/VgHTOOn2WHrR8eMOmfuYqhPzgEMJqRrQBYO9zm7M8czzGKdT5XAjnYZjCwxWqISRwY8l82+KeOx55XHhuiLH4jl8Zjl8bLoM+y0cZRLmEQHZSmdYFznArO/ncFutv6tcpyj6qc5U8C9zOtgC6ySYC83nzTUL7CL92yDPULdLeNu+H7MkFtvZ1/Ou5W0dmChhm9MHQ8APgh5oX3UPB84ALXzDIY3F4BW5OSuoXAcSoqc7QIg1hjT40jrtVXWADvoJ5ERdk72ZYJKe8lY0P8mRv8PDZDxnsXnJhV9hJRsyDHf0GGL6lfxvCfr3ecguxX/RvR1rz7wAXD8LfW5poUIehyTJhZ7C6ZghhabxvXAlL8A=
  file_glob : true
  file:
    - phat-linux-x64-portable.tar.gz
    - phat-linux-x64-update-full.tar.gz
    - phat-linux-x64-update-diff.tar.gz
    - phat-linux-x64-update.tar.gz
    - phat*.deb
    - phat*.rpm
  skip_cleanup: true
  on:
    repo: chgibb/PHAT
    tags: true
